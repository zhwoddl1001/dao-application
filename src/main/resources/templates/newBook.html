<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>ì±… ë“±ë¡í•˜ê¸°</title>
    <link href="/favicon.ico" rel="icon">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
<!--
1. form íƒœê·¸ë¥¼ ì´ìš©í•´ì„œ form íƒœê·¸ ë‚´ì— ì‘ì„±í•œ id ê°’ìœ¼ë¡œ
submit í•´ì„œ ë°ì´í„° ì €ì¥

2. form íƒœê·¸ ë‚´ button type ì„ button í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•˜ê³ 
   click í•´ì„œ ë°ì´í„° ì €ì¥

3. div íƒœê·¸ ë‚´ button type ì„ button í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•˜ê³ 
    click í•´ì„œ ë°ì´í„° ì €ì¥
 -->
<h1>ğŸ“ ì±… ë“±ë¡í•˜ê¸°</h1>
<div id="book">
    <label for="title">ì±… ì œëª© : </label>
    <input id="title" placeholder="ì±… ì œëª© ì…ë ¥" required type="text">

    <label for="author">ì €ì</label>
    <input id="author" placeholder="ì±… ì €ì ì…ë ¥" required type="text">

    <label for="genre">ì¥ë¥´</label>
    <input id="genre" placeholder="ì±… ì¥ë¥´ ì…ë ¥" required type="text">

    <label for="imagePath">ì´ë¯¸ì§€ ì„ íƒ</label>
    <input id="imagePath" required type="file">
    <button id="saveBook" type="button">ì €ì¥í•˜ê¸°</button>
</div>
<script>
    $("#saveBook").click(function () {
        let title = $("#title").val(); // input ë‚´ ë“¤ì–´ìˆëŠ” value ê°’ ê°€ì ¸ì˜¤ê¸°
        let author = $("#author").val();
        let genre = $("#genre").val();


        let formData = new FormData(); // ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ì „ë‹¬í•˜ëŠ” ê¸°ëŠ¥ ì‚¬ìš©
        formData.append("title", title);
        formData.append("author", author);
        formData.append("genre", genre);
        formData.append("file",$("#imagePath")[0].files[0]); //file ì»¨íŠ¸ë¡¤ëŸ¬ì— ì €ì¥í•  ì´ë¦„
        $.ajax({
            url: "/api/bookSaveImg",
            method: "POST",
            processData: false, //FormData ë¥¼ ì „ì†¡í•  ë•Œ í•„ìš”
            contentType: false,//FormData ë¥¼ ì „ì†¡í•  ë•Œ í•„ìš”
            data:formData,
            success: function () {
                alert("ì±…ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
                // window = í™”ë©´ ì°½  location = ì§€ì—­ href = ì£¼ì†Œ
                // í•´ë‹¹í•˜ëŠ” ì£¼ì†Œ ì§€ì—­ìœ¼ë¡œ í™”ë©´ì„ ì´ë™í•œë‹¤.
                window.location.href = "/books"; //ViewControll erì—ì„œ ì±…ëª©ë¡ í™•ì¸í•˜ëŠ” api = url ì£¼ì†Œ
                // ë§Œì•½ì— ì°½ ì´ë™ì„ í•˜ì§€ ì•Šì„ ê²½ìš° ê¸°ì¡´ì— ì‘ì„±í•œ
                // title, author, genre ì— .val('') ì„ ë„£ì–´ ê°’ ë¹„ìš°ê¸° ì„¤ì •
            },
            error: function () {
                alert("ë°ì´í„° ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }
        })
    });
</script>

</body>
</html>